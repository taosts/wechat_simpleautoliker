# wechat_simpleautoliker
A simple script program, written in Python, uses a fusion of image recognition and simulated keyboard commands to automatically like and forward snacks on public account pages.
//一个简单的脚本程序，利用python编写，利用图像识别和模拟键盘指令融合的方式实现在公众号页面下自动点赞转发点心操作。
📜 公众号自动化处理脚本 - 纪念版前言：这个 Python 脚本最初设计用于自动化对某个公众号的所有已发布文章进行“点赞、转发、收藏”操作。后来证实：该操作完全没有实际意义。 尽管如此，整个程序经过多次迭代，整体运行良好，没有明显 Bug，故保留下来作为技术纪念。✨ 脚本概览这是一个专为 Windows 11 平台设计的 微信 PC 版“公众号”自动化处理脚本。它结合了 pywinauto（基于 UI 元素）和 pyautogui（基于图像识别）两种技术来模拟人工操作，自动浏览订阅号文章列表，并根据用户的选择，智能执行 “点赞/收藏” 或 “转发给文件传输助手” 等操作。状态记忆： 能自动记录和读取日志（processed_log.txt），从上次中断的日期继续执行。智能追赶： 当检测到处理进度落后时（如应用崩溃重启），能自动追回进度。🚀 主要功能与用法脚本启动时，会提示用户选择处理模式：[1] 点赞/收藏 或 [2] 转发。1. 模式选择模式名称操作流程1自动点赞/收藏自动打开文章，寻找并点击“点赞”和“收藏”图标。2自动转发自动打开文章，模拟点击“转发” $\rightarrow$ “文件传输助手” $\rightarrow$ “发送”。2. 状态记忆 (上下文感知)脚本会自动从 processed_log.txt 读取上次处理的最后日期。在滚动浏览时，能“记住”当前所属的日期（“粘性日期”），以解决一屏内没有日期标题时的日期判断问题。3. 两阶段智能追赶机制当脚本进度落后于当前日期时，将采用以下机制追赶：阶段差距范围定位方式描述外部工具驱动$>$ 15 天按键精灵脚本自动按下 F10 键，调用预设的按键精灵脚本进行快速滚动；在预设时间后，按 F12 停止，并重新评估进度。滚轮精炼定位$\le$ 15 天模拟滚轮切换为直接模拟小幅度的鼠标滚轮滚动，以进行精细定位和追赶。4. 容错与稳定机制机制名称描述失位重校准在高速滚动后如果“迷路”（找不到日期），会自动向上滚动以重新定位。智能休眠每成功处理一定数量的文章（如 16 篇），会自动休眠一段时间（如 12 秒），以防止微信程序因长时间高负荷运行而崩溃（这是先前遇到的主要问题）。💻 技术栈库/技术用途Python 3.x基础运行环境。pywinauto用于 Windows 窗口句柄控制、元素定位和键盘操作（如连接窗口、发送 F10/F12）。pyautogui核心，用于图像识别和鼠标模拟（如点击点赞、转发、发送按钮）。PyYAML用于解析 config.yml 配置文件。OpenCV (cv2) / Numpypyautogui 的底层依赖，用于图像处理。🛠️ 安装设置与启动步骤 1: 准备环境准备一个 Python 3.x 环境 (推荐使用 venv 虚拟环境)。步骤 2: 安装依赖在项目根目录下创建 requirements.txt 文件，内容如下：Plaintextpywinauto
pyautogui
pyyaml
opencv-python
numpy
然后运行命令安装所有依赖：Bashpip install -r requirements.txt
步骤 3: 准备图像模板脚本的运行严重依赖图像识别。启动前，必须手动截取以下 UI 元素的图片，并按文件名保存在项目根目录下的 templates 文件夹中：like.png (点赞图标)favorite.png (收藏图标)close.png (文章页的关闭 X 按钮)forward.png (文章页的转发图标)file_assistant.png (转发面板中的“文件传输助手”)send.png (转发确认面板中的绿色“发送”按钮)liked.png (已点赞状态的图标)favorited.png (已收藏状态的图标)注意： 截图时请尽量保持简洁和高辨识度，这直接决定了图像识别的准确率。步骤 4: 准备外部滚动工具 (可选)安装脚本精灵或其他宏工具，手动录制鼠标滚轮的下滚操作，然后设定：由 F10 启动。由 F12 停止。脚本会在追踪不到当前日期时自动运行这个外部操作。步骤 5: 微信窗口准备与桌面设置登录微信，打开公众号列表页面（能清晰看到日期和文章列表）。将此页面放在垂直水平居中位置，上下铺满，左右留空（防止程序误点到关闭按钮）。将桌面设置为不显示桌面图标。有条件的，可使用工具隐藏任务栏（例如 Hide Taskbar.exe），因为正常运行这个挂机程序时不再需要使用电脑。步骤 6: 编辑代码将主代码和配置文件中的文件路径替换成自己的路径（原作者已在代码中做好标记）。步骤 7: 启动脚本管理员模式进入 PowerShell。调整 PowerShell 窗口大小，使其不会遮挡公众号页面（建议放在屏幕左上角）。CD 进入你保存 main.py 的文件夹。开启虚拟 Python 环境：venv\Scripts\activate运行脚本：python main.py步骤 8: 查错与日志你可以在文件夹内的 processed_log.txt 中找到脚本上一次运行的结尾日期。原作者在代码中保留了保存识别结果截图的选项，解除对应的代码注释即可用于调试。
